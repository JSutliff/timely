<div class="dashboardWrap">

    <div class="navigate">
        <div class="navWrap">
            <div class="logo">
                <h1>Time.ly</h1>
            </div>

            <div class="profileTile">
                <h2 class="username">{{name}}</h2>
                <div class="profilePicture"></div>
            </div>

        </div>
    </div>

    <div class="dashboardMain">

        <div class="dashRow2">
            <div class="statsRow">
                <div class="statBox" value="moviesDash">
                    <img src="img/icons-06.png" alt="" class="icon">
                    <h2 class="timeLarge" id="movieStats" data-min="{{movieMin}}"></h2>
                </div>
                <div class="statBox" value="showsDash">
                    <img src="img/icons-08.png" alt="" class="icon">
                    <h2 class="timeLarge" id="showStats" data-min="{{showMin}}"></h2>
                </div>
                <div class="statBox" value="gamesDash">
                    <img src="img/icons-07.png" alt="" class="icon">
                    <h2 class="timeLarge" id="gameStats" data-min="{{gameMin}}"></h2>
                </div>
                <div class="statBox" value="booksDash">
                    <img src="img/icons-09.png" alt="" class="icon">
                    <h2 class="timeLarge" id="bookStats" data-min="{{bookMin}}"></h2>
                </div>
            </div>
        </div>

        <div class="dashRow3">

            <div class="container">
                <div class="dashSection" id="currentMedia">
                    {{#each inProgress}}
                    <div class="currentMediaIcon" style="background-image: url('{{this.imgUrl}}'')"></div>
                    <div class="currentMediaText">
                        <h2 class="blueLarge">{{this.name}}</h2>
                        <h2>{{this.minutes}}</h2>
                    </div>
                    {{/each}}
                </div>
                <div class="dashSection">
                    <canvas id="myChart" width="340" height="340"></canvas>
                    <div class="totalLogged">
                        <h2>Total time in queue: <span id="totalTimeLogged" class="boldBlue" data-min='{{totalMin}}'></span></h2>
                        
                    </div>
                </div>
            </div>

            <div class="container">
                <div class="dashSection backlog" id="backlog">
                    <div class="head">
                        <h1>Current Back Log</h1>
                        <h2 id="currentMediaType">MEDIA</h2>
                    </div>
                    <div class="thumbnailBox">
                        {{#each backlog}}
                        <div class="mediaThumbnail" style="background-image: url('{{this.imgUrl}}')">
                            <div class="changeToCurrent">
                                <h3 class="currentToggle" value="false">Make Current Media</h3>
                            </div>
                            <div class="mediaThumbnailText">
                                <h3 class="mediaThumbnailTitle">{{this.name}}</h3>
                                <h4 class="mediaThumbnailSubtitle"> {{this.minutes}}</h4>
                            </div>
                        </div>
                        {{/each}}
                    </div>
                </div>
            </div>

        </div>


    </div>

    <div class="footer">
    </div>

</div>

<div class="empty" data-something=""></div>

<script type="text/javascript">



    $(".statBox").on("click", function () {
        var dashCategory = $(this).attr("value")
        alert(dashCategory)
        // renderPage
    })

    $(".mediaThumbnail").on("click", function () {
        // grab mediaID from $(this)
        alert("Make Current Media")
    })

    function convertTime(minutes) {
        var time = minutes/60
        var hours = Math.floor( minutes / 60);
        var minutes = minutes % 60;
        var timeString = hours + "h " + minutes + "m"
        return timeString
    }

    var movieStats = $("#movieStats").attr("data-min")
    var gameStats = $("#gameStats").attr("data-min")
    var showStats = $("#showStats").attr("data-min")
    var bookStats = $("#bookStats").attr("data-min")

    var ctx = document.getElementById("myChart").getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ["Movies", "Shows", "Games", "Books"],
            datasets: [{
                label: 'time',
                data: [movieStats, gameStats, showStats, bookStats],
                backgroundColor: [
                    'rgba(255, 89, 94, 0.9)',
                    'rgba(254, 238, 158, 0.9)',
                    'rgba(142, 208, 129, 0.9)',
                    'rgba(22, 84, 158, 0.9)'
                ],
                borderColor: [
                    'rgba(255, 89, 94, 1)',
                    'rgba(254, 238, 158, 1)',
                    'rgba(142, 208, 129, 1)',
                    'rgba(22, 84, 158, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {}
    });

    function renderNumbers(movieStats, gameStats, showStats, bookStats) {
        movie = convertTime(movieStats);
        game = convertTime(gameStats);
        show = convertTime(showStats);
        book = convertTime(bookStats);

        $("#movieStats").html(movie);
        $("#gameStats").html(game);
        $("#showStats").html(show);
        $("#bookStats").html(book);
    }

    renderNumbers(movieStats, gameStats, showStats, bookStats)

    function renderTotalTime(time) {
        var totalTime = convertTime(time);
        $("#totalTimeLogged").html(totalTime);   
    }

    renderTotalTime($("#totalTimeLogged").attr("data-min"))

    function render() {
        renderNumbers()
        renderTotalTime()
    }

</script>